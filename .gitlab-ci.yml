stages:
  - release

.releaser: &release_template
  image:
    name: goreleaser/goreleaser:v1.25.1
    entrypoint: [""]
  variables:
    GIT_DEPTH: 0

release-test:
  <<: *release_template
  stage: test
  script:
    - goreleaser check

release:
  <<: *release_template
  stage: release
  script:
    - goreleaser
  only:
    - /^v\d+\.\d+\.\d+/
